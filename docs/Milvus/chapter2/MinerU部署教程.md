# MinerUéƒ¨ç½²æ•™ç¨‹

> æ•™ç¨‹å‚è€ƒï¼šhttps://mp.weixin.qq.com/s/ylVXT0dB_tcDG6zFPmwo8A

## ä»€ä¹ˆæ˜¯MinerUï¼Ÿ

MinerUæ˜¯ä¸€æ¬¾ç”±ä¸Šæµ·äººå·¥æ™ºèƒ½å®éªŒå®¤ OpenDataLab å›¢é˜Ÿå¼€å‘çš„å¼€æº PDF è½¬ Markdown å·¥å…·ï¼Œå¯ä»¥é«˜è´¨é‡åœ°æå– PDF æ–‡æ¡£å†…å®¹ï¼Œç”Ÿæˆç»“æ„åŒ–çš„ Markdown æ ¼å¼æ–‡æœ¬ï¼Œå¯ç”¨äºRAGã€LLMè¯­æ–™å‡†å¤‡ç­‰åœºæ™¯ã€‚

> ç¬”è€…è®°ï¼Œç¬”è€…æ ¹æ®è‡ªå·±çš„å®é™…ä½¿ç”¨ä½“éªŒæ¥çœ‹ï¼ŒMinerUåœ¨æ–‡æ¡£è§£æä¸Šå‡†ç¡®åº¦å¾ˆé«˜ï¼ŒåŒæ—¶å¼€æºéƒ¨ç½²ï¼Œéå¸¸é€‚åˆå­¦ä¹ ä½¿ç”¨

**å®˜æ–¹å®¢æˆ·ç«¯**ï¼š

*https://mineru.net/*

**MinerU Readme åœ°å€ï¼ˆä¸­æ–‡ï¼‰ï¼š**

*https://github.com/opendatalab/MinerU/blob/master/README_zh-CN.md*

MinerU ä»“åº“æ–‡æ¡£è¯´æ˜

```
MinerU/
â”œâ”€â”€ demo/                # ç”¨äºè¿è¡Œè½¬æ¢æ¼”ç¤ºçš„è„šæœ¬
â”œâ”€â”€ docker/              # ç”¨äºå®¹å™¨åŒ–çš„ Dockerfile é…ç½®æ–‡ä»¶
â”œâ”€â”€ docs/                # å­˜å‚¨å„ç±»è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ projects/            # å­˜æ”¾ç”± MinerU è¡ç”Ÿæˆ–ç›¸å…³çš„é¡¹ç›®
â”‚   â”œâ”€â”€ gradio_app/        # MinerU Gradio ç•Œé¢çš„æºä»£ç 
â”‚   â”œâ”€â”€ multi_gpu/         # ä¸º MinerU æä¾›å¤š GPU æ”¯æŒçš„è§£å†³æ–¹æ¡ˆ
â”‚   â”œâ”€â”€ web_api/           # æä¾›æœ¬åœ° Web API æ¥å£çš„æœåŠ¡ç«¯ä»£ç 
```

## MinerU åŠŸèƒ½ç‰¹æ€§

MinerUå…·æœ‰ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š

**1. æ–‡æ¡£å¤„ç†**

â— åˆ é™¤é¡µçœ‰ã€é¡µè„šã€è„šæ³¨ã€é¡µç ç­‰å…ƒç´ ï¼Œç¡®ä¿è¯­ä¹‰è¿è´¯

â— ä¿ç•™åŸæ–‡æ¡£çš„ç»“æ„ï¼ŒåŒ…æ‹¬æ ‡é¢˜ã€æ®µè½ã€åˆ—è¡¨ç­‰

â— æå–å›¾åƒã€å›¾ç‰‡æè¿°ã€è¡¨æ ¼ã€è¡¨æ ¼æ ‡é¢˜åŠè„šæ³¨

**2. æ ¼å¼è½¬æ¢**

â— è‡ªåŠ¨è¯†åˆ«å¹¶è½¬æ¢æ–‡æ¡£ä¸­çš„å…¬å¼ä¸ºLaTeXæ ¼å¼

â— è‡ªåŠ¨è¯†åˆ«å¹¶è½¬æ¢æ–‡æ¡£ä¸­çš„è¡¨æ ¼ä¸ºHTMLæ ¼å¼

**3. è¿è¡Œç¯å¢ƒ**

â— æ”¯æŒçº¯ CPU ç¯å¢ƒè¿è¡Œ

â— æ”¯æŒ GPU åŠ é€Ÿï¼Œæå‡å¤„ç†æ•ˆç‡

## æœ¬åœ°éƒ¨ç½²ç³»ç»Ÿè¦æ±‚

åœ¨å¼€å§‹å®‰è£…å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„ç³»ç»Ÿæ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š

### **åŸºç¡€ç¯å¢ƒ**

â— Python 3.10ï½3.13

â— Condaï¼ˆåŒ…ç®¡ç†å™¨ï¼‰

### GPUåŠ é€Ÿè¦æ±‚

â— NVIDIAæ˜¾å¡ï¼ˆæ˜¾å­˜â‰¥6GBï¼‰

åŸºç¡€ç¯å¢ƒé…ç½®æ¨èï¼š

# å®‰è£…æ•™ç¨‹

## 1.ç¯å¢ƒé…ç½®

### **1.1 åˆ›å»ºCondaç¯å¢ƒ**

```python
conda create -n mineru 'python=3.12' -y
conda activate mineru
pip install -U "magic-pdf[full]" -i https://mirrors.aliyun.com/pypi/simple 
#-i æ˜¯æŒ‡å®šå›½å†…çš„åŠ é€Ÿæºï¼Œå¯é€‰æ¸…åæºæˆ–é˜¿é‡Œäº‘æºï¼Œæ­¤å¤„ç”¨é˜¿é‡Œäº‘æºç¤ºä¾‹
```

### **1.2 ä¸‹è½½æ¨¡å‹æ–‡ä»¶**

```
æ–¹æ³•ä¸€ï¼šä»Hugging Faceä¸‹è½½æ¨¡å‹ï¼ˆå›½é™…ç”¨æˆ·æ¨èï¼‰

pip install huggingface_hub
curl -o download_models_hf.py https://gcore.jsdelivr.net/gh/opendatalab/MinerU@master/scripts/download_models_hf.py
python download_models_hf.py

æ–¹æ³•äºŒï¼šä»ModelScopeä¸‹è½½æ¨¡å‹ï¼ˆå›½å†…ç”¨æˆ·æ¨èï¼‰

pip install modelscope 
curl -o download_models.py https://gcore.jsdelivr.net/gh/opendatalab/MinerU@master/scripts/download_models.py
python download_models.py
```

æ¨¡å‹é»˜è®¤å­˜å‚¨è·¯å¾„ç¤ºä¾‹ï¼š

```
model_dir: C:\Users\ç”¨æˆ·å\.cache\modelscope\hub\models\opendatalab\PDF-Extract-Kit-1___0/models
layoutreader_model_dir: C:\Users\ç”¨æˆ·å\.cache\modelscope\hub\models\ppaanngggg\layoutreader
```

**ğŸ’¡æç¤º**ï¼š

ä¸‹è½½å®Œæˆåï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åœ¨ç”¨æˆ·ç›®å½•ä¸‹ç”Ÿæˆ `magic-pdf.json `é…ç½®æ–‡ä»¶ï¼Œä½ å¯ä»¥åœ¨è¿™ä¸ªé…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹éƒ¨åˆ†é…ç½®ï¼Œå®ç°ä¸åŒåŠŸèƒ½çš„å¼€å…³ï¼Œå¦‚è¡¨æ ¼è¯†åˆ«ã€å…¬å¼è¯†åˆ«å…³é—­æˆ–å¼€å¯ï¼ˆé»˜è®¤äºŒè€…éƒ½æ˜¯å¼€å¯çš„ï¼Œå…³é—­åªéœ€å°†å¯¹åº”çš„å€¼æ”¹ 'true' ä¸º 'false' ï¼‰ã€‚

ç”¨æˆ·ç›®å½•ä½ç½®ï¼š

â— Windowsï¼š`C:\Users\ç”¨æˆ·å`

â— Linuxï¼š`/home/ç”¨æˆ·å`

â— macOSï¼š`/Users/ç”¨æˆ·å`

## **2.** GPUåŠ é€Ÿé…ç½®

### **2.1** CUDAåŠ é€Ÿè®¾ç½®

è¿™é‡Œä»¥ Windowsï¼ˆNVIDIA æ˜¾å¡ï¼‰ ä¸ºä¾‹ã€‚å¦‚æœæ‚¨çš„ NVIDIA æ˜¾å¡æ˜¾å­˜ â‰¥ 6GBï¼Œå¯é…ç½® CUDA åŠ é€Ÿã€‚è¿™é‡Œæˆ‘ä»¬ä»¥ CUDA 12.8 å®‰è£…ä¸ºä¾‹ï¼š

```
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu128
```

ä¿®æ”¹ç”¨æˆ·ç›®å½•ä¸­é…ç½®æ–‡ä»¶ `magic-pdf.json `ï¼š

```

{
    // other config
    "device-mode": "cuda"
}
```

##  3. åŠŸèƒ½æµ‹è¯•

### **3.1 å•æ–‡ä»¶æµ‹è¯•**

æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è‡ªåŠ¨æµ‹è¯•åŠŸèƒ½ï¼š

```
cd demo
magic-pdf -p demo1.pdf -o ./output
```

### 3.2 æ‰¹é‡PDFè½¬æ¢

**æ­¥éª¤ 1ï¼šè·å–æ‰¹é‡è½¬æ¢è„šæœ¬**

ä¸‹è½½åä¸º `batch_demo.py` çš„ Python æ–‡ä»¶ã€‚ä½ å¯ä»¥å°†æ­¤æ–‡ä»¶ä¿å­˜åœ¨ä½ å¸Œæœ›æ‰§è¡Œè½¬æ¢çš„ä»»ä½•ç›®å½•ä¸‹ã€‚

```
ä¸‹è½½åœ°å€ï¼šhttps://github.com/opendatalab/MinerU/blob/master/demo/batch_demo.py
```

**æ­¥éª¤ 2ï¼šå‡†å¤‡ PDF æ–‡ä»¶**

åœ¨ `batch_demo.py` æ–‡ä»¶çš„ç›®å½•ä¸‹æ–°å»ºå¦‚ä¸‹æ–‡ä»¶å¤¹ï¼š

```
pdfs  # batch_demo.py ç›¸å¯¹äºè„šæœ¬çš„è·¯å¾„ 
```

**æ­¥éª¤ 3ï¼šæ‰§è¡Œæ‰¹é‡è½¬æ¢ï¼š**

æ‰“å¼€ä½ çš„ç»ˆç«¯æˆ–å‘½ä»¤æç¤ºç¬¦ï¼Œå¯¼èˆªåˆ°ä½ ä¿å­˜ `batch_demo.py` æ–‡ä»¶çš„ç›®å½•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„ `batch_demo.py` æ–‡ä»¶ä¿å­˜åœ¨ `demo` æ–‡ä»¶å¤¹ä¸­ï¼Œä½ å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```
cd demo
python batch_demo.py
```

**æ­¥éª¤ 4ï¼šæŸ¥çœ‹è½¬æ¢ç»“æœï¼š**

è½¬æ¢åçš„ç»“æœå°†é»˜è®¤è¾“å‡ºåˆ°ä¸ `batch_demo.py` æ–‡ä»¶åŒçº§ç›®å½•ä¸‹çš„ä¸€ä¸ªåä¸º `output` çš„æ–‡ä»¶å¤¹ä¸­ã€‚

```
output  # ç›¸å¯¹äºè„šæœ¬çš„è·¯å¾„
```

# æ­å»ºæœ¬åœ° **API** æœåŠ¡

> ç¬”è€…è®°ï¼Œæ¨èä½¿ç”¨dockeréƒ¨ç½²ï¼Œæ–¹ä¾¿è¿ç»´ï¼Œå› æ­¤è¿™é‡Œä¹Ÿåªå¤åˆ¶dockerç›¸å…³éƒ¨ç½²æ–¹æ³•

### **Dockerå®‰è£…æ–¹å¼**

####  **æ­¥éª¤ 1ï¼šæ„å»ºæ–¹å¼**

```python
docker build -t mineru-api .

æˆ–è€…ä½¿ç”¨ä»£ç†ï¼š

docker build --build-arg http_proxy=http://127.0.0.1:7890 --build-arg https_proxy=http://127.0.0.1:7890 -t mineru-api .
```

#### **æ­¥éª¤ 2ï¼šå¯åŠ¨å‘½ä»¤**

```
docker run --rm -it --gpus=all -p 8000:8000 mineru-api
```

ä¸Šè¿°ä»»æ„ä¸€ç§æ–¹å¼å®‰è£…å®Œæˆåï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹åœ°å€è®¿é—®ï¼ˆæµ‹è¯•ï¼‰

```
http://localhost:8000/docs
http://127.0.0.1:8000/docs
```

