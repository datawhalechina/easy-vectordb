# Annoyç®—æ³•

## 1. Annoyçš„çµæ„Ÿæ¥æºä¸æ ¸å¿ƒæ€æƒ³

**Annoy**ï¼ˆApproximate Nearest Neighbors Oh Yeahï¼‰æ˜¯ç”± **Spotify** å¼€å‘çš„ä¸€ä¸ªé«˜æ€§èƒ½è¿‘ä¼¼æœ€è¿‘é‚»æœç´¢åº“ï¼Œå…¶æ ¸å¿ƒæ•°æ®ç»“æ„æ˜¯**éšæœºæŠ•å½±æ ‘ï¼ˆRandom Projection Treesï¼‰**ã€‚

Annoyçš„è®¾è®¡ç›®æ ‡éå¸¸æ˜ç¡®ï¼š
- **ä½å†…å­˜å ç”¨**ï¼šç´¢å¼•å¯ä»¥é€šè¿‡å†…å­˜æ˜ å°„ï¼ˆmmapï¼‰æ–¹å¼åŠ è½½ï¼Œå¤šä¸ªè¿›ç¨‹å¯ä»¥å…±äº«åŒä¸€ä»½ç´¢å¼•ï¼Œæå¤§é™ä½å†…å­˜å¼€é”€
- **é«˜æŸ¥è¯¢é€Ÿåº¦**ï¼šé€šè¿‡æ ‘ç»“æ„å¿«é€Ÿç¼©å°æœç´¢èŒƒå›´
- **æ˜“äºä½¿ç”¨**ï¼šç®€å•çš„APIï¼Œä¾¿äºé›†æˆåˆ°ç”Ÿäº§ç³»ç»Ÿ

### æ ¸å¿ƒæ€æƒ³

> **é€šè¿‡å¤šæ£µéšæœºæ„å»ºçš„äºŒå‰æ ‘ï¼Œå°†é«˜ç»´ç©ºé—´é€’å½’åˆ†å‰²æˆè¶Šæ¥è¶Šå°çš„åŒºåŸŸï¼Œç›¸ä¼¼çš„å‘é‡ä¼šå¤§æ¦‚ç‡è¢«åˆ†åˆ°åŒä¸€ä¸ªå¶å­èŠ‚ç‚¹ã€‚**

Annoyçš„æˆåŠŸæºäºä¸¤ä¸ªå…³é”®æ€æƒ³ï¼š

**1. éšæœºæŠ•å½±æ ‘ï¼ˆRandom Projection Treesï¼‰**

æƒ³è±¡ä½ åœ¨ä¸€ä¸ªæ‹¥æŒ¤çš„å›¾ä¹¦é¦†é‡Œæ‰¾ä¹¦ï¼š
- **ä¸æ˜¯æŒ‰ç…§ä½œè€…ã€ä¸»é¢˜ç­‰å›ºå®šè§„åˆ™åˆ†ç±»**ï¼ˆé‚£æ ·éœ€è¦å®Œç¾çš„åˆ†ç±»æ ‡å‡†ï¼‰
- **è€Œæ˜¯éšæœºé€‰æ‹©ä¸¤æœ¬ä¹¦ä½œä¸º"é”šç‚¹"ï¼Œç„¶åæŠŠå…¶ä»–ä¹¦æŒ‰"æ›´æ¥è¿‘å“ªæœ¬é”šç‚¹ä¹¦"åˆ†æˆä¸¤å †**
- **é‡å¤è¿™ä¸ªè¿‡ç¨‹**ï¼Œæ¯æ¬¡åœ¨ä¸€å †ä¹¦ä¸­å†é€‰ä¸¤æœ¬åšé”šç‚¹ï¼Œç»§ç»­äºŒåˆ†
- æœ€ç»ˆï¼Œç›¸ä¼¼çš„ä¹¦ä¼šè‡ªç„¶åœ°èšåœ¨ä¸€èµ·

è¿™å°±æ˜¯Annoyçš„æ ¸å¿ƒï¼š**ç”¨éšæœºè¶…å¹³é¢é€’å½’åœ°äºŒåˆ†ç©ºé—´**ã€‚

**2. æ£®æ—ç­–ç•¥ï¼ˆForest of Treesï¼‰**

å•æ£µéšæœºæ ‘å¯èƒ½ä¼š"è¿æ°”ä¸å¥½"ï¼ŒæŠŠç›¸ä¼¼çš„å‘é‡åˆ†å¼€ã€‚æ€ä¹ˆåŠï¼Ÿ
- **å»ºç«‹å¤šæ£µæ ‘**ï¼ˆå°±åƒå¤šæ¬¡ç”¨ä¸åŒçš„éšæœºæ–¹å¼æ•´ç†å›¾ä¹¦é¦†ï¼‰
- **æŸ¥è¯¢æ—¶åœ¨æ‰€æœ‰æ ‘ä¸­æœç´¢**ï¼Œåˆå¹¶å€™é€‰ç»“æœ
- åªè¦æœ‰ä¸€æ£µæ ‘æŠŠç›¸ä¼¼å‘é‡åˆ†åˆ°ä¸€èµ·ï¼Œå°±èƒ½æ‰¾åˆ°å®ƒä»¬

è¿™ç§"ç”¨å¤šæ¬¡éšæœºå°è¯•æé«˜æˆåŠŸç‡"çš„æ€æƒ³ï¼Œåœ¨æœºå™¨å­¦ä¹ ä¸­å«åš**é›†æˆå­¦ä¹ ï¼ˆEnsemble Learningï¼‰**ã€‚

---

## 2. ç®—æ³•åŸç†åˆ†æ­¥è¯¦è§£

Annoyï¼ˆ**Random Projection Tree Forest**ï¼‰æ˜¯ä¸€ç§åŸºäº**äºŒå‰æ ‘æ£®æ—**çš„è¿‘ä¼¼æœ€è¿‘é‚»æœç´¢ç®—æ³•ã€‚  
å®ƒé€šè¿‡æ„å»ºå¤šæ£µéšæœºæŠ•å½±æ ‘ï¼Œå°†é«˜ç»´å‘é‡ç©ºé—´é€’å½’åˆ†å‰²ï¼Œä½¿ç›¸ä¼¼å‘é‡å¤§æ¦‚ç‡è½å…¥åŒä¸€å¶èŠ‚ç‚¹ã€‚

å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š

> **å…ˆç”¨æ ‘ç»“æ„å¿«é€Ÿå®šä½åˆ°æŸ¥è¯¢å‘é‡é™„è¿‘çš„å°åŒºåŸŸï¼Œå†åœ¨å€™é€‰åŒºåŸŸå†…ç²¾ç¡®è®¡ç®—è·ç¦»ã€‚**

ä¸‹é¢æˆ‘ä»¬æ¥åˆ†æ­¥è§£æ Annoy çš„å·¥ä½œåŸç†ã€‚

---

### 1. æ ‘çš„æ„å»ºï¼ˆIndex Constructionï¼‰

Annoy çš„æ ¸å¿ƒæ•°æ®ç»“æ„æ˜¯**äºŒå‰æ ‘æ£®æ—**ï¼ˆå¤šæ£µç‹¬ç«‹çš„äºŒå‰æ ‘ï¼‰ã€‚  
æ¯æ£µæ ‘é€šè¿‡**éšæœºæŠ•å½±**çš„æ–¹å¼é€’å½’åœ°å°†ç©ºé—´åˆ†å‰²æˆä¸¤åŠã€‚

#### æ­¥éª¤ 1ï¼šéšæœºé€‰æ‹©åˆ†å‰²è¶…å¹³é¢

å¯¹äºå½“å‰èŠ‚ç‚¹åŒ…å«çš„å‘é‡é›†åˆï¼š

1. **éšæœºé€‰æ‹©ä¸¤ä¸ªå‘é‡** \( v_1 \) å’Œ \( v_2 \)ï¼ˆè¿™ä¸¤ä¸ªå‘é‡ç§°ä¸º"é”šç‚¹"ï¼‰
2. **è®¡ç®—ä¸­å‚è¶…å¹³é¢**ï¼šè¿™ä¸ªè¶…å¹³é¢å°†ç©ºé—´åˆ†æˆä¸¤åŠ
   - è¶…å¹³é¢è¿‡ \( v_1 \) å’Œ \( v_2 \) çš„ä¸­ç‚¹
   - è¶…å¹³é¢çš„æ³•å‘é‡æ˜¯ \( v_1 - v_2 \)

è¿™ä¸ªè¶…å¹³é¢å°±åƒä¸€æŠŠ"éšæœºçš„åˆ€"ï¼ŒæŠŠå½“å‰ç©ºé—´åˆ‡æˆä¸¤åŠã€‚

---

#### æ­¥éª¤ 2ï¼šé€’å½’åˆ†å‰²ç©ºé—´

æ ¹æ®å‘é‡åœ¨è¶…å¹³é¢çš„å“ªä¸€ä¾§ï¼Œå°†å‘é‡é›†åˆåˆ†æˆä¸¤ä¸ªå­é›†ï¼š
- **å·¦å­æ ‘**ï¼šåŒ…å«æ‰€æœ‰åœ¨è¶…å¹³é¢"å·¦ä¾§"çš„å‘é‡
- **å³å­æ ‘**ï¼šåŒ…å«æ‰€æœ‰åœ¨è¶…å¹³é¢"å³ä¾§"çš„å‘é‡

é€’å½’åœ°å¯¹æ¯ä¸ªå­é›†é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°æ»¡è¶³åœæ­¢æ¡ä»¶ï¼š
- å½“å‰èŠ‚ç‚¹åŒ…å«çš„å‘é‡æ•°é‡ â‰¤ è®¾å®šé˜ˆå€¼ï¼ˆå¦‚ K=5ï¼‰
- è¾¾åˆ°æœ€å¤§æ ‘æ·±åº¦

æ­¤æ—¶ï¼Œå½“å‰èŠ‚ç‚¹å˜æˆ**å¶å­èŠ‚ç‚¹**ï¼Œå­˜å‚¨è¿™äº›å‘é‡çš„ç´¢å¼•ã€‚

---

#### æ­¥éª¤ 3ï¼šæ„å»ºå¤šæ£µæ ‘ï¼ˆæ£®æ—ï¼‰

ç”±äºå•æ£µæ ‘çš„åˆ†å‰²æ˜¯éšæœºçš„ï¼Œå¯èƒ½ä¼šï¼š
- "è¿æ°”ä¸å¥½"æŠŠç›¸ä¼¼çš„å‘é‡åˆ†å¼€
- å¯¼è‡´æŸ¥è¯¢æ—¶æ¼æ‰çœŸæ­£çš„è¿‘é‚»

**è§£å†³æ–¹æ¡ˆ**ï¼šæ„å»º `n_trees` æ£µç‹¬ç«‹çš„æ ‘ï¼Œæ¯æ£µæ ‘ç”¨ä¸åŒçš„éšæœºç§å­ã€‚

- æ ‘è¶Šå¤šï¼Œæ‰¾åˆ°çœŸå®è¿‘é‚»çš„æ¦‚ç‡è¶Šé«˜
- ä½†æ„å»ºæ—¶é—´å’Œå†…å­˜å ç”¨ä¹Ÿä¼šå¢åŠ 

---

### 2. æŸ¥è¯¢é˜¶æ®µï¼ˆSearch Processï¼‰

ç»™å®šæŸ¥è¯¢å‘é‡ \( q \)ï¼ŒAnnoy ä½¿ç”¨æ ‘ç»“æ„å¿«é€Ÿå®šä½å€™é€‰å‘é‡ã€‚

#### æ­¥éª¤ 1ï¼šåœ¨æ¯æ£µæ ‘ä¸­å‘ä¸‹éå†

å¯¹äºæ£®æ—ä¸­çš„æ¯æ£µæ ‘ï¼š

1. ä»æ ¹èŠ‚ç‚¹å¼€å§‹
2. åœ¨æ¯ä¸ªå†…éƒ¨èŠ‚ç‚¹ï¼Œåˆ¤æ–­ \( q \) åœ¨åˆ†å‰²è¶…å¹³é¢çš„å“ªä¸€ä¾§
3. æ ¹æ®åˆ¤æ–­ç»“æœï¼Œé€’å½’è¿›å…¥å·¦å­æ ‘æˆ–å³å­æ ‘
4. åˆ°è¾¾å¶å­èŠ‚ç‚¹åï¼Œæ”¶é›†è¯¥å¶å­èŠ‚ç‚¹ä¸­çš„æ‰€æœ‰å‘é‡ç´¢å¼•

è¿™ä¸ªè¿‡ç¨‹éå¸¸å¿«ï¼Œå¤æ‚åº¦æ˜¯ \( O(\log N) \)ï¼Œå…¶ä¸­ \( N \) æ˜¯å‘é‡æ€»æ•°ã€‚

---

#### æ­¥éª¤ 2ï¼šåˆå¹¶å€™é€‰é›†

å°†æ‰€æœ‰æ ‘ä¸­æ”¶é›†åˆ°çš„å‘é‡ç´¢å¼•åˆå¹¶ï¼Œå»é‡ï¼Œå¾—åˆ°å€™é€‰é›†ã€‚

å€™é€‰é›†çš„å¤§å°ç”±å‚æ•° `search_k` æ§åˆ¶ï¼š
- `search_k` è¶Šå¤§ï¼Œæœç´¢çš„å¶å­èŠ‚ç‚¹è¶Šå¤š
- å¬å›ç‡è¶Šé«˜ï¼Œä½†æŸ¥è¯¢æ—¶é—´ä¹Ÿè¶Šé•¿

---

#### æ­¥éª¤ 3ï¼šç²¾ç¡®è®¡ç®—è·ç¦»å¹¶è¿”å› Top-K

å¯¹å€™é€‰é›†ä¸­çš„æ¯ä¸ªå‘é‡ï¼Œè®¡ç®—ä¸æŸ¥è¯¢å‘é‡ \( q \) çš„çœŸå®è·ç¦»ï¼ˆå¦‚æ¬§æ°è·ç¦»æˆ–ä½™å¼¦è·ç¦»ï¼‰ã€‚

æŒ‰è·ç¦»æ’åºï¼Œè¿”å›æœ€è¿‘çš„ K ä¸ªå‘é‡ã€‚

---

### 3. å…³é”®å‚æ•°è¯´æ˜

| å‚æ•° | å«ä¹‰ | ä½œç”¨ |
|------|------|------|
| `n_trees` | æ„å»ºçš„æ ‘çš„æ•°é‡ | è¶Šå¤§å¬å›ç‡è¶Šé«˜ï¼Œä½†æ„å»ºæ—¶é—´å’Œå†…å­˜å ç”¨å¢åŠ  |
| `search_k` | æŸ¥è¯¢æ—¶æ£€æŸ¥çš„èŠ‚ç‚¹æ•°é‡ | è¶Šå¤§å¬å›ç‡è¶Šé«˜ï¼Œä½†æŸ¥è¯¢æ—¶é—´è¶Šé•¿ |
| `K`ï¼ˆå¶å­å¤§å°ï¼‰ | å¶å­èŠ‚ç‚¹æœ€å¤šåŒ…å«çš„å‘é‡æ•° | è¶Šå°æ ‘è¶Šæ·±ï¼ŒæŸ¥è¯¢è¶Šç²¾ç¡®ä½†æ„å»ºè¶Šæ…¢ |

---

### 4. Annoy çš„æ€§èƒ½ç‰¹ç‚¹

- **æ„å»ºé€Ÿåº¦å¿«**ï¼šéšæœºåˆ†å‰²ï¼Œæ— éœ€å¤æ‚çš„èšç±»æˆ–ä¼˜åŒ–
- **å†…å­˜å‹å¥½**ï¼šç´¢å¼•å¯ä»¥ mmapï¼Œå¤šè¿›ç¨‹å…±äº«
- **æŸ¥è¯¢é€Ÿåº¦å¿«**ï¼šæ ‘ç»“æ„ä½¿æœç´¢å¤æ‚åº¦ä¸º \( O(\log N) \)
- **æ˜“äºè°ƒå‚**ï¼šåªæœ‰ä¸¤ä¸ªä¸»è¦å‚æ•°ï¼ˆ`n_trees` å’Œ `search_k`ï¼‰

---

### 5. ç±»æ¯”ç†è§£

å¯ä»¥æŠŠ Annoy æƒ³è±¡æˆä¸€ä¸ª"å¿«é€ŸæŸ¥å­—å…¸"çš„æ¸¸æˆï¼š

| ç±»æ¯” | Annoy å¯¹åº”æ¦‚å¿µ |
|------|---------------|
| å­—å…¸æŒ‰é¦–å­—æ¯åˆ†æˆ26ä¸ªéƒ¨åˆ† | æ ¹èŠ‚ç‚¹çš„ç¬¬ä¸€æ¬¡äºŒåˆ† |
| æ¯ä¸ªéƒ¨åˆ†å†æŒ‰ç¬¬äºŒä¸ªå­—æ¯ç»†åˆ† | ç»§ç»­é€’å½’äºŒåˆ† |
| æœ€ç»ˆå®šä½åˆ°å…·ä½“é¡µç  | åˆ°è¾¾å¶å­èŠ‚ç‚¹ |
| ç”¨å¤šæœ¬ä¸åŒæ’åºçš„å­—å…¸ | æ„å»ºå¤šæ£µæ ‘ï¼ˆæ£®æ—ï¼‰ |

åœ¨æŸ¥è¯¢æ—¶ï¼š
- å…ˆåœ¨æ¯æœ¬å­—å…¸ä¸­å¿«é€Ÿç¿»åˆ°å¯¹åº”é¡µï¼ˆæ ‘éå†ï¼‰
- åˆå¹¶æ‰€æœ‰å­—å…¸æ‰¾åˆ°çš„å€™é€‰è¯ï¼ˆåˆå¹¶å€™é€‰é›†ï¼‰
- ç²¾ç¡®æ¯”è¾ƒæ‰¾å‡ºæœ€åŒ¹é…çš„è¯ï¼ˆè·ç¦»è®¡ç®—ï¼‰

---

**âœ… æ€»ç»“ï¼šAnnoy çš„æ ¸å¿ƒæ€æƒ³**

> **éšæœºæŠ•å½±æ ‘æ£®æ— + å¿«é€Ÿæ ‘éå† + å€™é€‰é›†åˆå¹¶**

Annoy é€šè¿‡å¤šæ£µéšæœºæ„å»ºçš„äºŒå‰æ ‘ï¼Œå°†é«˜ç»´ç©ºé—´é€’å½’åˆ†å‰²ï¼Œ  
ä½¿ç›¸ä¼¼å‘é‡å¤§æ¦‚ç‡è½å…¥åŒä¸€å¶å­èŠ‚ç‚¹ï¼Œä»è€Œå®ç°**å¿«é€Ÿä¸”å†…å­˜å‹å¥½**çš„è¿‘ä¼¼æœ€è¿‘é‚»æœç´¢ã€‚

å®ƒåœ¨ **Spotify** çš„éŸ³ä¹æ¨èç³»ç»Ÿä¸­å¾—åˆ°äº†å¹¿æ³›åº”ç”¨ï¼Œ  
ä¹Ÿæ˜¯è®¸å¤šå‘é‡æ•°æ®åº“ï¼ˆå¦‚ **Qdrant**ï¼‰æ”¯æŒçš„ä¸»æµç´¢å¼•ç®—æ³•ä¹‹ä¸€ã€‚

---

## 3. Annoyç®—æ³•å®ç°

ğŸ§  Annoyç®—æ³•Pythonå®ç°

### 3.1 å¯¼å…¥å¿…è¦çš„åº“

```python
import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
from sklearn.metrics.pairwise import euclidean_distances
import time
from collections import defaultdict

# å¼ºåˆ¶è®¾ç½®ä¸­æ–‡å­—ä½“ï¼Œè§£å†³ä¸­æ–‡æ˜¾ç¤ºé—®é¢˜
plt.rcParams['font.sans-serif'] = ['PingFang SC', 'Microsoft YaHei', 'SimHei', 'Arial Unicode MS', 'DejaVu Sans']
plt.rcParams['axes.unicode_minus'] = False

# è®¾ç½®éšæœºç§å­ä»¥ä¿è¯ç»“æœå¯é‡ç°
np.random.seed(42)
```

### 3.2 å®ç°éšæœºæŠ•å½±æ ‘èŠ‚ç‚¹

```python
class AnnoyTreeNode:
    """Annoyæ ‘çš„èŠ‚ç‚¹"""
    
    def __init__(self, indices):
        """
        åˆå§‹åŒ–èŠ‚ç‚¹
        
        å‚æ•°:
        - indices: å½“å‰èŠ‚ç‚¹åŒ…å«çš„å‘é‡ç´¢å¼•åˆ—è¡¨
        """
        self.indices = indices  # å½“å‰èŠ‚ç‚¹åŒ…å«çš„å‘é‡ç´¢å¼•
        self.left = None  # å·¦å­æ ‘
        self.right = None  # å³å­æ ‘
        
        # åˆ†å‰²è¶…å¹³é¢å‚æ•°
        self.split_vector1 = None  # ç¬¬ä¸€ä¸ªé”šç‚¹å‘é‡
        self.split_vector2 = None  # ç¬¬äºŒä¸ªé”šç‚¹å‘é‡
        self.split_point = None  # ä¸­ç‚¹
        self.split_normal = None  # æ³•å‘é‡
        
        self.is_leaf = False  # æ˜¯å¦ä¸ºå¶å­èŠ‚ç‚¹
```

### 3.3 å®ç°Annoyç´¢å¼•ç±»

```python
class SimpleAnnoy:
    """ç®€åŒ–çš„Annoyå®ç°ï¼Œç”¨äºå­¦ä¹ æ¼”ç¤º"""
    
    def __init__(self, n_trees=5, max_leaf_size=10):
        """
        åˆå§‹åŒ–Annoyç´¢å¼•
        
        å‚æ•°:
        - n_trees: æ„å»ºçš„æ ‘çš„æ•°é‡
        - max_leaf_size: å¶å­èŠ‚ç‚¹æœ€å¤§åŒ…å«çš„å‘é‡æ•°
        """
        self.n_trees = n_trees
        self.max_leaf_size = max_leaf_size
        self.trees = []  # å­˜å‚¨æ‰€æœ‰çš„æ ‘
        self.data_points = []  # å­˜å‚¨æ‰€æœ‰æ•°æ®ç‚¹
        
    def _build_tree(self, indices, data, depth=0, max_depth=20):
        """
        é€’å½’æ„å»ºå•æ£µAnnoyæ ‘
        
        å‚æ•°:
        - indices: å½“å‰èŠ‚ç‚¹åŒ…å«çš„å‘é‡ç´¢å¼•
        - data: æ‰€æœ‰æ•°æ®ç‚¹
        - depth: å½“å‰æ·±åº¦
        - max_depth: æœ€å¤§æ·±åº¦
        """
        node = AnnoyTreeNode(indices)
        
        # åœæ­¢æ¡ä»¶ï¼šèŠ‚ç‚¹åŒ…å«çš„å‘é‡æ•°é‡å°äºé˜ˆå€¼æˆ–è¾¾åˆ°æœ€å¤§æ·±åº¦
        if len(indices) <= self.max_leaf_size or depth >= max_depth:
            node.is_leaf = True
            return node
        
        # éšæœºé€‰æ‹©ä¸¤ä¸ªä¸åŒçš„å‘é‡ä½œä¸ºé”šç‚¹
        if len(indices) < 2:
            node.is_leaf = True
            return node
            
        idx1, idx2 = np.random.choice(indices, size=2, replace=False)
        v1, v2 = data[idx1], data[idx2]
        
        # å¦‚æœä¸¤ä¸ªå‘é‡ç›¸åŒï¼Œç›´æ¥è¿”å›å¶å­èŠ‚ç‚¹
        if np.allclose(v1, v2):
            node.is_leaf = True
            return node
        
        # è®¡ç®—åˆ†å‰²è¶…å¹³é¢
        node.split_vector1 = v1
        node.split_vector2 = v2
        node.split_point = (v1 + v2) / 2  # ä¸­ç‚¹
        node.split_normal = v1 - v2  # æ³•å‘é‡
        
        # æ ¹æ®å‘é‡åœ¨è¶…å¹³é¢çš„å“ªä¸€ä¾§è¿›è¡Œåˆ†å‰²
        left_indices = []
        right_indices = []
        
        for idx in indices:
            vec = data[idx]
            # è®¡ç®—å‘é‡åˆ°ä¸­ç‚¹çš„å‘é‡ä¸æ³•å‘é‡çš„ç‚¹ç§¯
            # å¦‚æœç‚¹ç§¯ > 0ï¼Œè¯´æ˜åœ¨v1ä¸€ä¾§ï¼›å¦åˆ™åœ¨v2ä¸€ä¾§
            projection = np.dot(vec - node.split_point, node.split_normal)
            if projection >= 0:
                left_indices.append(idx)
            else:
                right_indices.append(idx)
        
        # å¦‚æœåˆ†å‰²åæŸä¸€ä¾§ä¸ºç©ºï¼Œè¯´æ˜åˆ†å‰²å¤±è´¥ï¼Œè¿”å›å¶å­èŠ‚ç‚¹
        if len(left_indices) == 0 or len(right_indices) == 0:
            node.is_leaf = True
            return node
        
        # é€’å½’æ„å»ºå·¦å³å­æ ‘
        node.left = self._build_tree(left_indices, data, depth + 1, max_depth)
        node.right = self._build_tree(right_indices, data, depth + 1, max_depth)
        
        return node
    
    def build_index(self, data):
        """
        æ„å»ºAnnoyç´¢å¼•ï¼ˆæ£®æ—ï¼‰
        
        å‚æ•°:
        - data: æ•°æ®ç‚¹æ•°ç»„
        """
        self.data_points = np.array(data)
        n_samples = len(self.data_points)
        
        print(f"å¼€å§‹æ„å»º{self.n_trees}æ£µæ ‘...")
        
        # æ„å»ºå¤šæ£µæ ‘
        for i in range(self.n_trees):
            # æ¯æ£µæ ‘ä½¿ç”¨æ‰€æœ‰æ•°æ®ç‚¹ï¼Œä½†éšæœºç§å­ä¸åŒ
            np.random.seed(i + 42)  # ä¸åŒçš„éšæœºç§å­
            tree = self._build_tree(list(range(n_samples)), self.data_points)
            self.trees.append(tree)
            
            if (i + 1) % max(1, self.n_trees // 5) == 0 or i == self.n_trees - 1:
                print(f"å·²æ„å»º{i + 1}/{self.n_trees}æ£µæ ‘")
        
        print("ç´¢å¼•æ„å»ºå®Œæˆï¼")
    
    def _search_tree(self, tree, query, search_k=None):
        """
        åœ¨å•æ£µæ ‘ä¸­æœç´¢
        
        å‚æ•°:
        - tree: æ ‘çš„æ ¹èŠ‚ç‚¹
        - query: æŸ¥è¯¢å‘é‡
        - search_k: æœç´¢çš„èŠ‚ç‚¹æ•°é‡é™åˆ¶
        
        è¿”å›:
        - å€™é€‰å‘é‡çš„ç´¢å¼•åˆ—è¡¨
        """
        candidates = []
        nodes_to_visit = [tree]
        nodes_visited = 0
        
        while nodes_to_visit:
            # å¦‚æœè®¾ç½®äº†search_ké™åˆ¶ï¼Œæ£€æŸ¥æ˜¯å¦å·²è®¿é—®è¶³å¤Ÿå¤šçš„èŠ‚ç‚¹
            if search_k is not None and nodes_visited >= search_k:
                break
            
            node = nodes_to_visit.pop(0)
            nodes_visited += 1
            
            if node.is_leaf:
                # åˆ°è¾¾å¶å­èŠ‚ç‚¹ï¼Œæ”¶é›†æ‰€æœ‰å‘é‡ç´¢å¼•
                candidates.extend(node.indices)
            else:
                # å†…éƒ¨èŠ‚ç‚¹ï¼Œåˆ¤æ–­æŸ¥è¯¢å‘é‡åœ¨å“ªä¸€ä¾§
                projection = np.dot(query - node.split_point, node.split_normal)
                if projection >= 0:
                    # åœ¨å·¦ä¾§
                    if node.left:
                        nodes_to_visit.append(node.left)
                else:
                    # åœ¨å³ä¾§
                    if node.right:
                        nodes_to_visit.append(node.right)
        
        return candidates
    
    def search(self, query, k=5, search_k=None):
        """
        æœç´¢æœ€è¿‘é‚»
        
        å‚æ•°:
        - query: æŸ¥è¯¢å‘é‡
        - k: è¿”å›çš„æœ€è¿‘é‚»æ•°é‡
        - search_k: æ¯æ£µæ ‘æœç´¢çš„èŠ‚ç‚¹æ•°é‡é™åˆ¶ï¼ˆNoneè¡¨ç¤ºä¸é™åˆ¶ï¼‰
        
        è¿”å›:
        - æœ€è¿‘é‚»çš„ç´¢å¼•å’Œè·ç¦»åˆ—è¡¨
        """
        if len(self.trees) == 0:
            raise ValueError("ç´¢å¼•æœªæ„å»ºï¼Œè¯·å…ˆè°ƒç”¨build_index")
        
        # åœ¨æ‰€æœ‰æ ‘ä¸­æœç´¢ï¼Œåˆå¹¶å€™é€‰é›†
        all_candidates = set()
        for tree in self.trees:
            candidates = self._search_tree(tree, query, search_k)
            all_candidates.update(candidates)
        
        # è®¡ç®—æ‰€æœ‰å€™é€‰å‘é‡ä¸æŸ¥è¯¢å‘é‡çš„çœŸå®è·ç¦»
        candidate_list = list(all_candidates)
        if not candidate_list:
            return [], []
        
        distances = euclidean_distances([query], self.data_points[candidate_list])[0]
        
        # æŒ‰è·ç¦»æ’åºï¼Œè¿”å›å‰kä¸ª
        sorted_indices = np.argsort(distances)[:k]
        result_indices = [candidate_list[i] for i in sorted_indices]
        result_distances = distances[sorted_indices]
        
        return result_indices, result_distances
    
    def brute_force_search(self, query, k=5):
        """æš´åŠ›æœç´¢ä½œä¸ºå¯¹æ¯”åŸºå‡†"""
        distances = euclidean_distances([query], self.data_points)[0]
        nearest_indices = np.argsort(distances)[:k]
        return nearest_indices, distances[nearest_indices]
```

### 3.4 ç”Ÿæˆç¤ºä¾‹æ•°æ®

```python
def generate_sample_data(n_samples=200, dim=2):
    """ç”Ÿæˆç¤ºä¾‹æ•°æ®ï¼šå››ä¸ªåˆ†ç¦»çš„é«˜æ–¯åˆ†å¸ƒç°‡"""
    # åˆ›å»ºå››ä¸ªç°‡
    cluster1 = np.random.normal(loc=[2, 2], scale=0.3, size=(n_samples//4, dim))
    cluster2 = np.random.normal(loc=[8, 3], scale=0.4, size=(n_samples//4, dim))
    cluster3 = np.random.normal(loc=[5, 8], scale=0.35, size=(n_samples//4, dim))
    cluster4 = np.random.normal(loc=[3, 6], scale=0.4, size=(n_samples - 3*(n_samples//4), dim))
    
    data = np.vstack([cluster1, cluster2, cluster3, cluster4])
    return data
```

### 3.5 æ€§èƒ½æ¼”ç¤ºå‡½æ•°

```python
def demonstrate_annoy_performance():
    """æ¼”ç¤ºAnnoyæ€§èƒ½å¯¹æ¯”"""
    print("=" * 60)
    print("Annoyç®—æ³•æ€§èƒ½æ¼”ç¤º")
    print("=" * 60)
    
    # ç”Ÿæˆå¤§è§„æ¨¡æµ‹è¯•æ•°æ®ï¼ˆä¿æŒç°‡çŠ¶åˆ†å¸ƒï¼‰
    data = generate_sample_data(100000, 2)
    print(f"ç”Ÿæˆ{len(data)}ä¸ªäºŒç»´æ•°æ®ç‚¹")
    
    # åˆ›å»ºAnnoyç´¢å¼•
    annoy = SimpleAnnoy(n_trees=10, max_leaf_size=10)
    
    # æ„å»ºç´¢å¼•
    print("\næ„å»ºAnnoyç´¢å¼•...")
    start_time = time.time()
    annoy.build_index(data)
    construction_time = time.time() - start_time
    print(f"Annoyç´¢å¼•æ„å»ºå®Œæˆï¼Œè€—æ—¶: {construction_time:.4f}ç§’")
    
    # é€‰æ‹©æŸ¥è¯¢ç‚¹
    query_point = np.array([5.0, 5.0])
    print(f"\næŸ¥è¯¢ç‚¹: {query_point}")
    
    # ä½¿ç”¨Annoyæœç´¢
    start_time = time.time()
    annoy_results, annoy_distances = annoy.search(query_point, k=5, search_k=50)
    annoy_time = time.time() - start_time
    
    # æš´åŠ›æœç´¢ä½œä¸ºåŸºå‡†
    start_time = time.time()
    bf_indices, bf_distances = annoy.brute_force_search(query_point, k=5)
    bf_time = time.time() - start_time
    
    # æ˜¾ç¤ºç»“æœå¯¹æ¯”
    print(f"\næœç´¢ç»“æœå¯¹æ¯”:")
    print(f"Annoyæœç´¢ - æ‰¾åˆ°{len(annoy_results)}ä¸ªæœ€è¿‘é‚», è€—æ—¶: {annoy_time:.6f}ç§’")
    print(f"æš´åŠ›æœç´¢ - æ‰¾åˆ°{len(bf_indices)}ä¸ªæœ€è¿‘é‚», è€—æ—¶: {bf_time:.6f}ç§’")
    
    print(f"\né€Ÿåº¦æå‡: {bf_time/annoy_time:.2f}å€")
    
    print(f"\nAnnoyç»“æœç´¢å¼•: {annoy_results}")
    print(f"Annoyç»“æœè·ç¦»: {annoy_distances}")
    print(f"æš´åŠ›æœç´¢ç»“æœç´¢å¼•: {bf_indices.tolist()}")
    print(f"æš´åŠ›æœç´¢ç»“æœè·ç¦»: {bf_distances}")
    
    # æ£€æŸ¥å¬å›ç‡
    annoy_indices_set = set(annoy_results)
    bf_indices_set = set(bf_indices)
    intersection = annoy_indices_set & bf_indices_set
    recall = len(intersection) / len(bf_indices_set)
    print(f"å¬å›ç‡: {recall:.2%} ({len(intersection)}/{len(bf_indices_set)})")
    
    return annoy, data, query_point, annoy_results, bf_indices

# è¿è¡Œæ ‡å‡†æ¼”ç¤º
annoy, data, query, annoy_results, bf_results = demonstrate_annoy_performance()
```

è¾“å‡ºç»“æœï¼š

```text
============================================================
Annoyç®—æ³•æ€§èƒ½æ¼”ç¤º
============================================================
ç”Ÿæˆ100000ä¸ªäºŒç»´æ•°æ®ç‚¹

æ„å»ºAnnoyç´¢å¼•...
å¼€å§‹æ„å»º10æ£µæ ‘...
å·²æ„å»º5/10æ£µæ ‘
å·²æ„å»º10/10æ£µæ ‘
ç´¢å¼•æ„å»ºå®Œæˆï¼
Annoyç´¢å¼•æ„å»ºå®Œæˆï¼Œè€—æ—¶: 38.9665ç§’

æŸ¥è¯¢ç‚¹: [5. 5.]

æœç´¢ç»“æœå¯¹æ¯”:
Annoyæœç´¢ - æ‰¾åˆ°5ä¸ªæœ€è¿‘é‚», è€—æ—¶: 0.002012ç§’
æš´åŠ›æœç´¢ - æ‰¾åˆ°5ä¸ªæœ€è¿‘é‚», è€—æ—¶: 0.016312ç§’

é€Ÿåº¦æå‡: 8.11å€

Annoyç»“æœç´¢å¼•: [76568, 87053, 99758, 86413, 85476]
Annoyç»“æœè·ç¦»: [0.67309842 0.71583121 0.76414983 0.80066059 0.85234455]
æš´åŠ›æœç´¢ç»“æœç´¢å¼•: [76568, 87053, 99758, 86413, 85476]
æš´åŠ›æœç´¢ç»“æœè·ç¦»: [0.67309842 0.71583121 0.76414983 0.80066059 0.85234455]
å¬å›ç‡: 100.00% (5/5)
```

### 3.6 å¯è§†åŒ–Annoyç®—æ³•

```python
def visualize_annoy(annoy, data, query_point, annoy_results, bf_results):
    """å¯è§†åŒ–Annoyç®—æ³•"""
    fig = plt.figure(figsize=(20, 12))
    
    # 1. åŸå§‹æ•°æ®åˆ†å¸ƒ
    ax1 = fig.add_subplot(2, 3, 1)
    ax1.scatter(data[:, 0], data[:, 1], c='lightblue', alpha=0.6, s=30, label='æ•°æ®ç‚¹')
    ax1.scatter(query_point[0], query_point[1], c='#FFD93D', marker='*', s=200, 
               edgecolors='black', label='æŸ¥è¯¢ç‚¹')
    ax1.set_title('1. åŸå§‹æ•°æ®åˆ†å¸ƒ', fontweight='bold')
    ax1.legend()
    ax1.grid(True, alpha=0.3)
    
    # 2. ç¬¬ä¸€æ£µæ ‘çš„ç©ºé—´åˆ†å‰²ï¼ˆå¯è§†åŒ–å‰å‡ å±‚ï¼‰
    ax2 = fig.add_subplot(2, 3, 2)
    ax2.scatter(data[:, 0], data[:, 1], c='lightgray', alpha=0.4, s=20, label='æ•°æ®ç‚¹')
    
    # å¯è§†åŒ–ç¬¬ä¸€æ£µæ ‘çš„åˆ†å‰²è¶…å¹³é¢ï¼ˆåªæ˜¾ç¤ºå‰å‡ å±‚ï¼‰
    def plot_splits(node, depth=0, max_depth=3):
        if node is None or node.is_leaf or depth >= max_depth:
            return
        
        # ç»˜åˆ¶åˆ†å‰²çº¿ï¼ˆ2Dæƒ…å†µä¸‹ï¼‰
        if node.split_normal is not None:
            # åˆ†å‰²çº¿å‚ç›´äºæ³•å‘é‡ï¼Œè¿‡ä¸­ç‚¹
            mid = node.split_point
            normal = node.split_normal
            
            # è®¡ç®—åˆ†å‰²çº¿çš„æ–¹å‘å‘é‡ï¼ˆå‚ç›´äºæ³•å‘é‡ï¼‰
            if abs(normal[1]) > 1e-10:
                direction = np.array([1, -normal[0] / normal[1]])
            else:
                direction = np.array([0, 1])
            
            # å½’ä¸€åŒ–æ–¹å‘å‘é‡
            direction = direction / np.linalg.norm(direction)
            
            # ç»˜åˆ¶åˆ†å‰²çº¿
            line_length = 15
            x_vals = [mid[0] - line_length * direction[0], mid[0] + line_length * direction[0]]
            y_vals = [mid[1] - line_length * direction[1], mid[1] + line_length * direction[1]]
            
            alpha = 0.8 - depth * 0.2
            ax2.plot(x_vals, y_vals, 'r-', alpha=max(alpha, 0.3), linewidth=2-depth*0.3,
                    label='åˆ†å‰²è¶…å¹³é¢' if depth == 0 else '')
            
            # æ ‡æ³¨é”šç‚¹
            if depth < 2:
                ax2.scatter([node.split_vector1[0], node.split_vector2[0]], 
                           [node.split_vector1[1], node.split_vector2[1]], 
                           c='red', marker='x', s=100, linewidths=2,
                           label='é”šç‚¹' if depth == 0 else '')
        
        # é€’å½’ç»˜åˆ¶å­æ ‘çš„åˆ†å‰²
        plot_splits(node.left, depth + 1, max_depth)
        plot_splits(node.right, depth + 1, max_depth)
    
    plot_splits(annoy.trees[0])
    ax2.scatter(query_point[0], query_point[1], c='#FFD93D', marker='*', s=200, 
               edgecolors='black', label='æŸ¥è¯¢ç‚¹')
    ax2.set_title('2. ç¬¬ä¸€æ£µæ ‘çš„ç©ºé—´åˆ†å‰²ï¼ˆå‰3å±‚ï¼‰', fontweight='bold')
    
    # å»é‡å›¾ä¾‹
    handles, labels = ax2.get_legend_handles_labels()
    by_label = dict(zip(labels, handles))
    ax2.legend(by_label.values(), by_label.keys())
    ax2.grid(True, alpha=0.3)
    ax2.set_xlim(data[:, 0].min() - 1, data[:, 0].max() + 1)
    ax2.set_ylim(data[:, 1].min() - 1, data[:, 1].max() + 1)
    
    # 3. æ ‘çš„éå†è·¯å¾„
    ax3 = fig.add_subplot(2, 3, 3)
    ax3.scatter(data[:, 0], data[:, 1], c='lightgray', alpha=0.3, s=20)
    
    # åœ¨ç¬¬ä¸€æ£µæ ‘ä¸­æ‰¾åˆ°æŸ¥è¯¢ç‚¹çš„è·¯å¾„
    def find_path_in_tree(node, query):
        path = [node]
        current = node
        while not current.is_leaf:
            projection = np.dot(query - current.split_point, current.split_normal)
            if projection >= 0 and current.left:
                current = current.left
            elif current.right:
                current = current.right
            else:
                break
            path.append(current)
        return path
    
    path = find_path_in_tree(annoy.trees[0], query_point)
    leaf_node = path[-1]
    
    # é«˜äº®å¶å­èŠ‚ç‚¹ä¸­çš„ç‚¹
    if leaf_node.is_leaf:
        leaf_indices = leaf_node.indices
        ax3.scatter(data[leaf_indices, 0], data[leaf_indices, 1], 
                   c='orange', s=80, alpha=0.8, edgecolors='black',
                   label=f'å¶å­èŠ‚ç‚¹({len(leaf_indices)}ä¸ªç‚¹)')
    
    ax3.scatter(query_point[0], query_point[1], c='#FFD93D', marker='*', s=200, 
               edgecolors='black', label='æŸ¥è¯¢ç‚¹')
    ax3.set_title('3. æŸ¥è¯¢ç‚¹åœ¨ç¬¬ä¸€æ£µæ ‘ä¸­çš„å®šä½', fontweight='bold')
    ax3.legend()
    ax3.grid(True, alpha=0.3)
    
    # 4. å¤šæ£µæ ‘çš„å€™é€‰é›†åˆå¹¶
    ax4 = fig.add_subplot(2, 3, 4)
    ax4.scatter(data[:, 0], data[:, 1], c='lightgray', alpha=0.3, s=20, label='æ•°æ®ç‚¹')
    
    # æ”¶é›†æ‰€æœ‰æ ‘çš„å€™é€‰ç‚¹
    all_tree_candidates = []
    for i, tree in enumerate(annoy.trees[:min(3, len(annoy.trees))]):  # åªæ˜¾ç¤ºå‰3æ£µæ ‘
        candidates = annoy._search_tree(tree, query_point)
        all_tree_candidates.append(candidates)
        
        # ç”¨ä¸åŒé¢œè‰²æ˜¾ç¤ºä¸åŒæ ‘çš„å€™é€‰ç‚¹
        colors_map = ['red', 'blue', 'green']
        ax4.scatter(data[candidates, 0], data[candidates, 1], 
                   c=colors_map[i], s=60, alpha=0.5, 
                   label=f'æ ‘{i+1}å€™é€‰({len(candidates)}ä¸ª)')
    
    ax4.scatter(query_point[0], query_point[1], c='#FFD93D', marker='*', s=200, 
               edgecolors='black', label='æŸ¥è¯¢ç‚¹')
    ax4.set_title(f'4. å¤šæ£µæ ‘çš„å€™é€‰é›†ï¼ˆå‰3æ£µæ ‘ï¼‰', fontweight='bold')
    ax4.legend()
    ax4.grid(True, alpha=0.3)
    
    # 5. Annoyæœç´¢ç»“æœ
    ax5 = fig.add_subplot(2, 3, 5)
    ax5.scatter(data[:, 0], data[:, 1], c='lightgray', alpha=0.4, s=20)
    ax5.scatter(data[annoy_results, 0], data[annoy_results, 1], 
               c='red', marker='o', s=60, edgecolors='darkred', 
               linewidth=2, label='Annoyç»“æœ')
    
    # æ ‡æ³¨æ’å
    for i, idx in enumerate(annoy_results[:5]):
        ax5.annotate(f'{i+1}', (data[idx, 0], data[idx, 1]), 
                    xytext=(3, 3), textcoords='offset points', 
                    fontsize=10, color='white', fontweight='bold',
                    bbox=dict(boxstyle='circle', facecolor='red', alpha=0.8))
    
    ax5.scatter(query_point[0], query_point[1], c='#FFD93D', marker='*', s=150, 
               edgecolors='black', linewidth=2, label='æŸ¥è¯¢ç‚¹')
    ax5.set_title('5. Annoyæœç´¢ç»“æœ', fontweight='bold')
    ax5.legend()
    ax5.grid(True, alpha=0.3)
    
    # 6. ç»“æœå¯¹æ¯”
    ax6 = fig.add_subplot(2, 3, 6)
    ax6.scatter(data[:, 0], data[:, 1], c='lightgray', alpha=0.3, s=15)
    
    # æš´åŠ›æœç´¢ç»“æœ
    ax6.scatter(data[bf_results, 0], data[bf_results, 1], 
               c='green', marker='s', s=100, edgecolors='darkgreen', 
               linewidth=2.5, label='æš´åŠ›æœç´¢ (çœŸå®ç­”æ¡ˆ)', alpha=0.5)
    
    # Annoyç»“æœ
    ax6.scatter(data[annoy_results, 0], data[annoy_results, 1], 
               c='red', marker='o', s=70, alpha=0.8, label='Annoyç»“æœ')
    
    # æŸ¥è¯¢ç‚¹
    ax6.scatter(query_point[0], query_point[1], c='#FFD93D', marker='*', s=150, 
               edgecolors='black', linewidth=2, label='æŸ¥è¯¢ç‚¹')
    
    # è®¡ç®—å¬å›ç‡
    intersection = set(annoy_results) & set(bf_results)
    recall = len(intersection) / len(bf_results)
    
    ax6.set_title(f'6. ç»“æœå¯¹æ¯” (å¬å›ç‡: {recall:.1%})', fontweight='bold')
    ax6.legend()
    ax6.grid(True, alpha=0.3)
    
    plt.tight_layout()
    plt.show()

# è°ƒç”¨å¯è§†åŒ–
visualize_annoy(annoy, data, query, annoy_results, bf_results)
```

![Annoyç®—æ³•å¯è§†åŒ–ç»“æœ](/images/Annoyç®—æ³•ç»“æœ.png)
*Annoyç®—æ³•å¯è§†åŒ–ç»“æœ*

---

**âœ… æ€»ç»“**

Annoyç®—æ³•é€šè¿‡éšæœºæŠ•å½±æ ‘æ£®æ—å®ç°äº†é«˜æ•ˆçš„è¿‘ä¼¼æœ€è¿‘é‚»æœç´¢ï¼š
- **æ„å»ºå¿«é€Ÿ**ï¼šéšæœºåˆ†å‰²ç­–ç•¥ç®€å•é«˜æ•ˆ
- **æŸ¥è¯¢é«˜æ•ˆ**ï¼šæ ‘ç»“æ„ä½¿æœç´¢å¤æ‚åº¦ä¸º O(log N)
- **å†…å­˜å‹å¥½**ï¼šæ”¯æŒå†…å­˜æ˜ å°„ï¼Œå¤šè¿›ç¨‹å…±äº«ç´¢å¼•
- **æ˜“äºè°ƒå‚**ï¼šåªéœ€è°ƒæ•´ `n_trees` å’Œ `search_k` ä¸¤ä¸ªå‚æ•°

**æ€§èƒ½äº®ç‚¹ï¼š**
åœ¨ 10 ä¸‡ä¸ª 2 ç»´å‘é‡çš„æ•°æ®é›†ä¸Šï¼š
- æŸ¥è¯¢é€Ÿåº¦ï¼š**8.11 å€**äºæš´åŠ›æœç´¢
- å¬å›ç‡ï¼š**100%**
- æŸ¥è¯¢è€—æ—¶ï¼š**ä»… 0.002 ç§’**

Annoyç‰¹åˆ«é€‚åˆï¼š
- **å¤§è§„æ¨¡å‘é‡æ•°æ®**ï¼ˆæ•°ä¸‡åˆ°æ•°ç™¾ä¸‡æ¡ï¼‰
- **å¯¹å†…å­˜å ç”¨æ•æ„Ÿ**çš„åº”ç”¨ï¼ˆå¦‚ç§»åŠ¨è®¾å¤‡ï¼‰
- **éœ€è¦å¤šè¿›ç¨‹å…±äº«ç´¢å¼•**çš„åœºæ™¯
- **å¯¹æŸ¥è¯¢å»¶è¿Ÿè¦æ±‚è¾ƒé«˜**çš„å®æ—¶ç³»ç»Ÿ

åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒAnnoyå·²è¢«å¹¿æ³›åº”ç”¨äºæ¨èç³»ç»Ÿï¼ˆSpotifyéŸ³ä¹æ¨èï¼‰ã€å›¾åƒæœç´¢ã€è‡ªç„¶è¯­è¨€å¤„ç†ç­‰é¢†åŸŸã€‚
